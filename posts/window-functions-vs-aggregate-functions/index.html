<!DOCTYPE html>
<html lang="en-us"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  
  






  
  
  
    
    
  





  



  
  

<link rel="stylesheet" href="https://oumayma-abassi.me/main.min.css" />


  
<meta name="robots" content="index, follow">
    <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  

<title>Window Functions vs Aggregate Functions</title>


<meta name="author" content="Oumayma Abassi">

<meta name="description" content="What’s the Difference and When to Use Each?">
<link rel="canonical" href="https://oumayma-abassi.me/posts/window-functions-vs-aggregate-functions/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Window Functions vs Aggregate Functions">
<meta property="og:description" content="What’s the Difference and When to Use Each?">
<meta property="og:url" content="https://oumayma-abassi.me/posts/window-functions-vs-aggregate-functions/">
<meta property="article:published_time" content="2025-08-05T00:00:00-04:00">
  <meta property="article:modified_time" content="2025-08-05T00:00:00-04:00">
  


  <meta name="og:image" content="https://oumayma-abassi.me/images/default.png"/>






  <meta name="twitter:site" content="oumayma_abassi">


  <meta name="twitter:creator" content="oumayma_abassi">

<meta name="twitter:title" content="Window Functions vs Aggregate Functions">
<meta name="twitter:description" content="What’s the Difference and When to Use Each?">



  <meta name="twitter:card" content="summary_large_image"/>
  <meta name="twitter:image" content="https://oumayma-abassi.me/images/default.png"/>





  


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@graph": [
    {
      "@type": "Person",
      "@id": "https://oumayma-abassi.me/#/schema/person/1",
      "name": "Oumayma Abassi",
      "url": "https://oumayma-abassi.me/",
      "image": {
        "@type": "ImageObject",
        "@id": "https://oumayma-abassi.me/#/schema/image/1",
        "url": "https://oumayma-abassi.me/images/default.png",
        "width": 453 ,
        "height": 455 ,
        "caption": "Oumayma Abassi"
      }
    },
    {
      "@type": "WebSite",
      "@id": "https://oumayma-abassi.me/#/schema/website/1",
      "url": "https://oumayma-abassi.me/",
      "name": "Oumayma Abassi",
      "description": "Personal blog and portfolio site of Oumayma Abassi.",
      "publisher": {
        "@id": "https://oumayma-abassi.me/#/schema/person/1"
      }
    },
    {
      "@type": "WebPage",
      "@id": "https://oumayma-abassi.me/posts/window-functions-vs-aggregate-functions/",
      "url": "https://oumayma-abassi.me/posts/window-functions-vs-aggregate-functions/",
      "name": "Window Functions vs Aggregate Functions",
      "description": "What’s the Difference and When to Use Each?",
      "isPartOf": {
        "@id": "https://oumayma-abassi.me/#/schema/website/1"
      },
      "about": {
        "@id": "https://oumayma-abassi.me/#/schema/person/1"
      },
      "datePublished": "2025-08-05T00:00:00-04:00",
      "dateModified": "2025-08-05T00:00:00-04:00",
      "breadcrumb": {
        "@id": "https://oumayma-abassi.me/posts/window-functions-vs-aggregate-functions/#/schema/breadcrumb/1"
      },
      "primaryImageOfPage": {
        "@id": "https://oumayma-abassi.me/posts/window-functions-vs-aggregate-functions/#/schema/image/2"
      },
      "inLanguage": "en-US",
      "potentialAction": [{
        "@type": "ReadAction", "target": ["https://oumayma-abassi.me/posts/window-functions-vs-aggregate-functions/"]
      }]
    },
    {
      "@type": "BreadcrumbList",
      "@id": "https://oumayma-abassi.me/posts/window-functions-vs-aggregate-functions/#/schema/breadcrumb/1",
      "name": "Breadcrumbs",
      "itemListElement": [{
        "@type": "ListItem",
        "position":  1 ,
        "item": {
          "@type": "WebPage",
          "@id": "https://oumayma-abassi.me/",
          "url": "https://oumayma-abassi.me/",
          "name": "Home"
          }
        },{
        "@type": "ListItem",
        "position":  2 ,
        "item": {
          "@type": "WebPage",
          "@id": "https://oumayma-abassi.me/posts/",
          "url": "https://oumayma-abassi.me/posts/",
          "name": "Posts"
          }
        },{
        "@type": "ListItem",
        "position":  3 ,
        "item": {
          "@id": "https://oumayma-abassi.me/posts/window-functions-vs-aggregate-functions/"
          }
        }]
    },
    {
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "Article",
          "@id": "https://oumayma-abassi.me/#/schema/article/1",
          "headline": "Window Functions vs Aggregate Functions",
          "description": "What’s the Difference and When to Use Each?",
          "isPartOf": {
            "@id": "https://oumayma-abassi.me/posts/window-functions-vs-aggregate-functions/"
          },
          "mainEntityOfPage": {
            "@id": "https://oumayma-abassi.me/posts/window-functions-vs-aggregate-functions/"
          },
          "datePublished": "2025-08-05T00:00:00-04:00",
          "dateModified": "2025-08-05T00:00:00-04:00",
          "author": {
            "@id": "https://oumayma-abassi.me/#/schema/person/1"
          },          
          "publisher": {
            "@id": "https://oumayma-abassi.me/#/schema/person/1"
          },
          "image": {
            "@id": "https://oumayma-abassi.me/posts/window-functions-vs-aggregate-functions/#/schema/image/2"
          }
        }
      ]
    },{
      "@context": "https://schema.org",
      "@graph": [
        {
          "@type": "ImageObject",
          "@id": "https://oumayma-abassi.me/posts/window-functions-vs-aggregate-functions/#/schema/image/2",
          "url": "https://oumayma-abassi.me/images/default.png",
          "contentUrl": "https://oumayma-abassi.me/images/default.png",
          "caption": "Window Functions vs Aggregate Functions"
        }
      ]
    }
  ]
}
</script>
  

  

</head><body>
    <header class="container">
  <nav class="main-nav" id="js-navbar">
    <a class="logo" href="https://oumayma-abassi.me/">Oumayma Abassi</a>
    <ul class="menu" id="js-menu">
      
      
      
        <li class="menu-item">
          <a href="/about/" class="menu-link">About</a>
        </li>
      
      
      
        <li class="menu-item">
          <a href="/projects/" class="menu-link">Projects</a>
        </li>
      
      
      
        <li class="menu-item">
          <a href="/posts/" class="menu-link">Blog</a>
        </li>
      
      
      
        <li class="menu-item">
          <a href="/contact/" class="menu-link">Contact</a>
        </li>
      
      
      
        <li class="menu-item">
          <a href="/cv/" class="menu-link">CV</a>
        </li>
      
      
      <li class="menu-item--align">
        <div class="switch">
          <input class="switch-input" type="checkbox" id="themeSwitch">
          <label aria-hidden="true" class="switch-label" for="themeSwitch">On</label>
          <div aria-hidden="true" class="switch-marker"></div>
        </div>
      </li>
    </ul>
    <span class="nav-toggle" id="js-navbar-toggle">
      <svg xmlns="http://www.w3.org/2000/svg" id="Outline" viewBox="0 0 24 24" width="30" height="30" fill="var(--color-contrast-high)"><rect y="11" width="24" height="2" rx="1"/><rect y="4" width="24" height="2" rx="1"/><rect y="18" width="24" height="2" rx="1"/></svg>
    </span>
  </nav>
</header><main class="section">
<div class="container">
  <section class="page-header">
    <h1 class="page-header-title">Window Functions vs Aggregate Functions</h1>
    <div class="post-list-meta">
      <div class="post-list-dates">Aug 5, 2025&nbsp;&middot;&nbsp;4 min.</div>
      
      <div class="post-list-categories">
        
          <a href="https://oumayma-abassi.me/categories/exploratory-data-analysis/">Exploratory Data Analysis</a>
        
      </div>
      
      
    </div>
    <p class="page-header-desc">What’s the Difference and When to Use Each?</p>
    <div class="single-terms">
      
    </div>
  </section>
</div>
<div class="single-container-post">
  

  <aside class="toc">
    <div id="js-toc-toggle">
      <h2 class="toc-header">Table of Contents</h2>
      <span class="toc-drop-icon">&blacktriangledown;</span>
    </div>
    <div id="js-toc-contents" class="toc-contents"><nav id="TableOfContents">
  <ul>
    <li><a href="#aggregate-functions-the-blender">Aggregate Functions: The Blender</a></li>
    <li><a href="#window-functions-the-chopper">Window Functions: The Chopper</a></li>
    <li><a href="#one-final-note-filtering">One Final Note: Filtering</a></li>
    <li><a href="#wrapping-up-knowing-which-tool-to-use">Wrapping Up: Knowing Which Tool to Use</a></li>
  </ul>
</nav></div>
  </aside>

  <div class="single-post-contents">
    <div class="single-feature-img">



  

</div>
    <article class="markdown">
        <p>If you’ve been writing SQL for a while, you’ve probably used aggregate functions like <code>SUM</code>,
<code>AVG</code>, or <code>COUNT</code> to get summary statistics. But then someone mentions window functions and
you wonder why use those if I can already aggregate my data? If this question ever crossed
your mind this article is for you. We will go through the similarities, the differences and some
examples.</p>
<p>Note: I will be using the Snowflake TPCH_SF1 sample data for the examples below so you can
recreate the results.</p>
<p>Although they look similar, aggregate functions and window functions behave very differently,
and knowing when to use each will save you from writing overly complex queries.</p>
<h2 id="aggregate-functions-the-blender">Aggregate Functions: The Blender<a href="#aggregate-functions-the-blender">
    <svg role="img" aria-labelledby="aggregate-functions-the-blender-IconTitle" fill="var(--color-primary)" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
      <title id="aggregate-functions-the-blender-IconTitle">Link to this heading</title>
      <path d="M0 0h24v24H0z" fill="none"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg>
  </a>
</h2><p>Aggregate functions, such as <code>SUM</code>, <code>AVG</code>, <code>COUNT</code>, <code>MAX</code>, and <code>MIN</code>, group rows together and
return a single value per group. They help answer questions like what is the average order price
per region? Or how many orders each customer makes per Q?</p>
<p>If the answer to your question is a single aggregated value in general or per group then an
aggregate function is the way to go.</p>
<p>You can think of it as a blender, you give it multiple data points and it summarises it down to one
result that represents all the input.</p>
<p><strong>Example:</strong></p>


  <span class="code-language">sql</span><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#66d9ef">SELECT</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    O_CUSTKEY, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style="color:#66d9ef">AVG</span>(O_TOTALPRICE) <span style="color:#66d9ef">AS</span> AVERAGE_ORDER 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#66d9ef">FROM</span> SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> O_CUSTKEY; </span></span></code></pre></div>
<p><strong>Results Snippet:</strong></p>
<table>
<thead>
<tr>
<th>O_CUSTKEY</th>
<th>AVERAGE_ORDER</th>
</tr>
</thead>
<tbody>
<tr>
<td>1910</td>
<td>129346.8600000000</td>
</tr>
<tr>
<td>74321</td>
<td>166403.0200000000</td>
</tr>
<tr>
<td>22052</td>
<td>183089.4550000000</td>
</tr>
<tr>
<td>86840</td>
<td>243148.4400000000</td>
</tr>
<tr>
<td>40787</td>
<td>164023.1266666667</td>
</tr>
<tr>
<td>141908</td>
<td>256498.7666666667</td>
</tr>
<tr>
<td>18455</td>
<td>137463.4500000000</td>
</tr>
<tr>
<td>81878</td>
<td>118406.8150000000</td>
</tr>
<tr>
<td>48365</td>
<td>196978.3700000000</td>
</tr>
<tr>
<td>86269</td>
<td>137881.3233333333</td>
</tr>
</tbody>
</table>
<p>As you can see, this makes aggregate functions the best solution when you need a quick
overview of your data without going into details. We can see the average order value for each
customer, but we have no idea about the details that went into that number.</p>
<p>This brings us to where aggregate functions lack behind. Now if we go back to our blender
example, if I were to give you a smoothie and ask you to compare its taste to each ingredient
that went into making it that would be near impossible if you don’t know the ingredients to start
with right? That’s where window functions come to use.</p>
<h2 id="window-functions-the-chopper">Window Functions: The Chopper<a href="#window-functions-the-chopper">
    <svg role="img" aria-labelledby="window-functions-the-chopper-IconTitle" fill="var(--color-primary)" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
      <title id="window-functions-the-chopper-IconTitle">Link to this heading</title>
      <path d="M0 0h24v24H0z" fill="none"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg>
  </a>
</h2><p>Same as aggregate functions, window functions perform calculations across rows, but they
leave the rows intact. Let’s say you want to compare customers’ order values to the average
order value. You will need to keep all the rows containing the order values and add a column
containing the overall average.</p>
<p>This is exactly what a window function does. Instead of <code>GROUP BY</code>, it used an <code>OVER</code> clause to
know which groups to aggregate on while keeping the original rows.</p>
<p>Now going back to the kitchen, you can think of it as a chopper you use to make a salad. You do
get the main result of combining all your ingredients but still you can distinguish them apart.</p>
<p><strong>Example:</strong></p>


  <span class="code-language">sql</span><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#66d9ef">SELECT</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    O_CUSTKEY, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    O_TOTALPRICE, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    <span style="color:#66d9ef">AVG</span>(O_TOTALPRICE) OVER(PARTITION <span style="color:#66d9ef">BY</span> O_CUSTKEY) <span style="color:#66d9ef">AS</span> AVERAGE_ORDER 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#66d9ef">FROM</span> SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> O_CUSTKEY; </span></span></code></pre></div>
<p><strong>Results Snippet:</strong></p>
<table>
<thead>
<tr>
<th>O_CUSTKEY</th>
<th>O_TOTALPRICE</th>
<th>AVERAGE_ORDER</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>123076.84</td>
<td>97960.48500</td>
</tr>
<tr>
<td>1</td>
<td>74602.81</td>
<td>97960.48500</td>
</tr>
<tr>
<td>1</td>
<td>174645.94</td>
<td>97960.48500</td>
</tr>
<tr>
<td>1</td>
<td>95911.01</td>
<td>97960.48500</td>
</tr>
<tr>
<td>1</td>
<td>54048.26</td>
<td>97960.48500</td>
</tr>
<tr>
<td>1</td>
<td>65478.05</td>
<td>97960.48500</td>
</tr>
<tr>
<td>2</td>
<td>167016.61</td>
<td>146896.20428</td>
</tr>
<tr>
<td>2</td>
<td>174291.41</td>
<td>146896.20428</td>
</tr>
<tr>
<td>2</td>
<td>221397.35</td>
<td>146896.20428</td>
</tr>
<tr>
<td>2</td>
<td>33082.83</td>
<td>146896.20428</td>
</tr>
</tbody>
</table>
<p>Now, we can see each individual order price along the average for that customer. This allows us
to do deeper analyses and comparisons.</p>
<h2 id="one-final-note-filtering">One Final Note: Filtering<a href="#one-final-note-filtering">
    <svg role="img" aria-labelledby="one-final-note-filtering-IconTitle" fill="var(--color-primary)" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
      <title id="one-final-note-filtering-IconTitle">Link to this heading</title>
      <path d="M0 0h24v24H0z" fill="none"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg>
  </a>
</h2><p>Now it is important to note that filtering for each type of those functions is different.</p>
<p>For aggregate functions we use a <code>HAVING</code> clause while repeating the function expression:</p>


  <span class="code-language">sql</span><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#66d9ef">SELECT</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    O_CUSTKEY, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    <span style="color:#66d9ef">AVG</span>(O_TOTALPRICE) <span style="color:#66d9ef">AS</span> AVERAGE_ORDER 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span><span style="color:#66d9ef">FROM</span> SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#66d9ef">GROUP</span> <span style="color:#66d9ef">BY</span> O_CUSTKEY 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span><span style="color:#66d9ef">HAVING</span> <span style="color:#66d9ef">AVG</span>(O_TOTALPRICE) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">10000</span>; </span></span></code></pre></div>
<p>And for window functions we can use a CTE or, when using snowflake, we can use a <code>QUALIFY</code>
clause:</p>
<p><strong>CTE</strong></p>


  <span class="code-language">sql</span><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#66d9ef">WITH</span> ORDER_AVG <span style="color:#66d9ef">AS</span> ( 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>    <span style="color:#66d9ef">SELECT</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>        O_CUSTKEY, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>        O_TOTALPRICE, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>        <span style="color:#66d9ef">AVG</span>(O_TOTALPRICE) OVER (PARTITION <span style="color:#66d9ef">BY</span> O_CUSTKEY) <span style="color:#66d9ef">AS</span> AVERAGE_ORDER 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>    <span style="color:#66d9ef">FROM</span> SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>) 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span><span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#66d9ef">FROM</span> order_avg 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span><span style="color:#66d9ef">WHERE</span> AVERAGE_ORDER <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">150000</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> O_CUSTKEY; </span></span></code></pre></div>
<p><strong>QUALIFY</strong></p>


  <span class="code-language">sql</span><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span><span style="color:#66d9ef">SELECT</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>    O_CUSTKEY, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>    O_TOTALPRICE, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>    <span style="color:#66d9ef">AVG</span>(O_TOTALPRICE) OVER (PARTITION <span style="color:#66d9ef">BY</span> O_CUSTKEY) <span style="color:#66d9ef">AS</span> AVERAGE_ORDER 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span><span style="color:#66d9ef">FROM</span> SNOWFLAKE_SAMPLE_DATA.TPCH_SF1.ORDERS 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>QUALIFY AVERAGE_ORDER <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">150000</span> 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span><span style="color:#66d9ef">ORDER</span> <span style="color:#66d9ef">BY</span> O_CUSTKEY; </span></span></code></pre></div>
<h2 id="wrapping-up-knowing-which-tool-to-use">Wrapping Up: Knowing Which Tool to Use<a href="#wrapping-up-knowing-which-tool-to-use">
    <svg role="img" aria-labelledby="wrapping-up-knowing-which-tool-to-use-IconTitle" fill="var(--color-primary)" height="22" viewBox="0 0 24 24" width="22" xmlns="http://www.w3.org/2000/svg">
      <title id="wrapping-up-knowing-which-tool-to-use-IconTitle">Link to this heading</title>
      <path d="M0 0h24v24H0z" fill="none"></path>
      <path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76.0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71.0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71.0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76.0 5-2.24 5-5s-2.24-5-5-5z"></path>
    </svg>
  </a>
</h2><p>Aggregate and Window functions are one of the most used tools in querying data, and
understanding when to use each helps us write more efficient and readable queries.</p>
<p>So next time you&rsquo;re writing SQL and trying to decide between <code>GROUP BY</code> and <code>OVER</code>, just ask
yourself: Do I want a smoothie or a salad?</p>

    </article>
    <aside>
      <div class="single-terms">
        
      </div>
      
  
  
  

  <section>
    <h2>Share</h2>
    <div class="social-links">
      <ul class="social-icons--share">
        
        
        <a href="https://twitter.com/intent/tweet?url=https%3a%2f%2foumayma-abassi.me%2fposts%2fwindow-functions-vs-aggregate-functions%2f&amp;text=Window%20Functions%20vs%20Aggregate%20Functions" target="_blank" rel="noopener" aria-label="Share on Twitter" class="social-btn twitter">
          <li><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-twitter" width="24" height="24" viewBox="0 0 384 312" fill="var(--color-primary)"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5 0-78.8 35.3-78.8 78.8 0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3-6.7 11.6-10.6 25.2-10.6 39.6 0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1 0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4 0-12.6-.4-18.8-1.1 34.9 22.4 76.3 35.4 120.8 35.4 144.9 0 224.1-120 224.1-224.1 0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg></li>
        </a>
        
        
        
        <a href="https://www.reddit.com/submit?url=https%3a%2f%2foumayma-abassi.me%2fposts%2fwindow-functions-vs-aggregate-functions%2f" target="_blank" rel="noopener" aria-label="Share on Reddit" class="social-btn reddit">
          <li><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-reddit" width="24" height="24" viewBox="0 0 24 24" fill="var(--color-primary)"><path d="M24 11.779c0-1.459-1.192-2.645-2.657-2.645-.715 0-1.363.286-1.84.746-1.81-1.191-4.259-1.949-6.971-2.046l1.483-4.669 4.016.941-.006.058c0 1.193.975 2.163 2.174 2.163 1.198 0 2.172-.97 2.172-2.163s-.975-2.164-2.172-2.164c-.92 0-1.704.574-2.021 1.379l-4.329-1.015c-.189-.046-.381.063-.44.249l-1.654 5.207c-2.838.034-5.409.798-7.3 2.025-.474-.438-1.103-.712-1.799-.712-1.465 0-2.656 1.187-2.656 2.646 0 .97.533 1.811 1.317 2.271-.052.282-.086.567-.086.857 0 3.911 4.808 7.093 10.719 7.093s10.72-3.182 10.72-7.093c0-.274-.029-.544-.075-.81.832-.447 1.405-1.312 1.405-2.318zm-17.224 1.816c0-.868.71-1.575 1.582-1.575.872 0 1.581.707 1.581 1.575s-.709 1.574-1.581 1.574-1.582-.706-1.582-1.574zm9.061 4.669c-.797.793-2.048 1.179-3.824 1.179l-.013-.003-.013.003c-1.777 0-3.028-.386-3.824-1.179-.145-.144-.145-.379 0-.523.145-.145.381-.145.526 0 .65.647 1.729.961 3.298.961l.013.003.013-.003c1.569 0 2.648-.315 3.298-.962.145-.145.381-.144.526 0 .145.145.145.379 0 .524zm-.189-3.095c-.872 0-1.581-.706-1.581-1.574 0-.868.709-1.575 1.581-1.575s1.581.707 1.581 1.575-.709 1.574-1.581 1.574z"/></svg></li>
        </a>
        
        
                
        <a href="https://www.facebook.com/sharer.php?u=https%3a%2f%2foumayma-abassi.me%2fposts%2fwindow-functions-vs-aggregate-functions%2f" target="_blank" rel="noopener" aria-label="Share on Facebook" class="social-btn facebook">
          <li><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-facebook" width="24" height="24" viewBox="0 0 352 352" fill="var(--color-primary)"><path d="m0 32v288c0 17.5 14.5 32 32 32h288c17.5 0 32-14.5 32-32v-288c0-17.5-14.5-32-32-32h-288c-17.5 0-32 14.5-32 32zm320 0v288h-83v-108h41.5l6-48h-47.5v-31c0-14 3.5-23.5 23.5-23.5h26v-43.5c-4.4-.6-19.8-1.5-37.5-1.5-36.9 0-62 22.2-62 63.5v36h-42v48h42v108h-155v-288z"/></svg></li>
        </a>
        
        
        
        <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2foumayma-abassi.me%2fposts%2fwindow-functions-vs-aggregate-functions%2f&amp;source=https%3a%2f%2foumayma-abassi.me%2fposts%2fwindow-functions-vs-aggregate-functions%2f&amp;title=Window%20Functions%20vs%20Aggregate%20Functions&amp;summary=Window%20Functions%20vs%20Aggregate%20Functions" target="_blank" rel="noopener" aria-label="Share on LinkedIn" class="social-btn linkedin">
          <li><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-linkedin" width="24" height="24" viewBox="0 0 352 352" fill="var(--color-primary)"><path d="M0,40v272c0,21.9,18.1,40,40,40h272c21.9,0,40-18.1,40-40V40c0-21.9-18.1-40-40-40H40C18.1,0,0,18.1,0,40z M312,32 c4.6,0,8,3.4,8,8v272c0,4.6-3.4,8-8,8H40c-4.6,0-8-3.4-8-8V40c0-4.6,3.4-8,8-8H312z M59.5,87c0,15.2,12.3,27.5,27.5,27.5 c15.2,0,27.5-12.3,27.5-27.5c0-15.2-12.3-27.5-27.5-27.5C71.8,59.5,59.5,71.8,59.5,87z M187,157h-1v-21h-45v152h47v-75 c0-19.8,3.9-39,28.5-39c24.2,0,24.5,22.4,24.5,40v74h47v-83.5c0-40.9-8.7-72-56.5-72C208.5,132.5,193.3,145.1,187,157z M64,288h47.5 V136H64V288z"/></svg></li>
        </a>
        
        
        
        <a href="mailto:?subject=Oumayma%20Abassi%20-%20Window%20Functions%20vs%20Aggregate%20Functions.&amp;body=Window%20Functions%20vs%20Aggregate%20Functions%2c%20by%20Oumayma%20Abassi%0aWhat%e2%80%99s%20the%20Difference%20and%20When%20to%20Use%20Each%3f%0a%0ahttps%3a%2f%2foumayma-abassi.me%2fposts%2fwindow-functions-vs-aggregate-functions%2f%0a" target="_blank" class="social-btn email">
          <li><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-mail" width="24" height="24" viewBox="0 0 416 288" fill="var(--color-primary)"><path d="m0 16v256 16h16 384 16v-16-256-16h-16-384-16zm347 16-139 92.5-139-92.5zm-148 125.5 9 5.5 9-5.5 167-111.5v210h-352v-210z"/></svg></li>
        </a>
      </ul>
    </div>
  </section>
  
        

  
  

        
  <section>
    <h2>Read Next</h2>
    <div class="single-next-previous">
      
        <a class="previous" href="https://oumayma-abassi.me/posts/machine-learning-101/">&laquo; Machine Learning 101</a>
      
      
    </div>
  </section>

      
    </aside>
  </div>
</div>

    </main><footer>
  
  <div class="section footer">
    <p class="footer-copyright">&copy; 2025 &middot; 
      <a href="https://oumayma-abassi.me/">Oumayma Abassi</a>
      
    </p>
    
      <div class="footer-socials">
        
<div class="social-links">
  <ul class="social-icons">
    
    
    <li>
      <a href="https://twitter.com/oumayma_abassi" target="_blank" rel="noopener" aria-label="Visit Twitter profile" class="social-btn twitter">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-twitter" width="24" height="24" viewBox="0 0 384 312" fill="var(--color-primary)"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5 0-78.8 35.3-78.8 78.8 0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3-6.7 11.6-10.6 25.2-10.6 39.6 0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1 0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4 0-12.6-.4-18.8-1.1 34.9 22.4 76.3 35.4 120.8 35.4 144.9 0 224.1-120 224.1-224.1 0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg>
      </a>
    </li>
    

    
    

    
    
    <li>
      <a href="https://github.com/Oumayma-Abassi" target="_blank" rel="noopener" aria-label="Visit Github profile" class="social-btn github">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-github" width="24" height="24" viewBox="0 0 24 24" fill="var(--color-primary)"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
      </a>
    </li>
    

    
    

    
    
    <li>
      <a href="https://www.linkedin.com/in/oumayma-abassi-662629218" target="_blank" rel="noopener" aria-label="Visit LinkedIn profile" class="social-btn linkedin">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-linkedin" width="24" height="24" viewBox="0 0 352 352" fill="var(--color-primary)"><path d="M0,40v272c0,21.9,18.1,40,40,40h272c21.9,0,40-18.1,40-40V40c0-21.9-18.1-40-40-40H40C18.1,0,0,18.1,0,40z M312,32 c4.6,0,8,3.4,8,8v272c0,4.6-3.4,8-8,8H40c-4.6,0-8-3.4-8-8V40c0-4.6,3.4-8,8-8H312z M59.5,87c0,15.2,12.3,27.5,27.5,27.5 c15.2,0,27.5-12.3,27.5-27.5c0-15.2-12.3-27.5-27.5-27.5C71.8,59.5,59.5,71.8,59.5,87z M187,157h-1v-21h-45v152h47v-75 c0-19.8,3.9-39,28.5-39c24.2,0,24.5,22.4,24.5,40v74h47v-83.5c0-40.9-8.7-72-56.5-72C208.5,132.5,193.3,145.1,187,157z M64,288h47.5 V136H64V288z"/></svg>
        </a>
    </li>
    

    
    
  </ul>
</div>

      </div>
    
  </div>
</footer>

  





  
  
  
    
    
  




  
  
    

<script src="https://oumayma-abassi.me/main.min.js"></script>



  
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RW7E4MDR61"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-RW7E4MDR61', { 'anonymize_ip': false });
}
</script>

</body>
</html>
